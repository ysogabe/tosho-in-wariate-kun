# Issue #006: 図書室API互換性対応

## 概要

フロントエンドの図書室管理画面で図書室情報を更新する際に、「TypeError: Failed to fetch」エラーが発生しています。これは、バックエンドAPIの互換性の問題によるものです。

## 背景

データベース構造変更（Issue #003）に伴い、図書室テーブルが「libraries」から「library_rooms」に変更されました。バックエンドAPIでは、GETリクエスト用の互換性エンドポイント（`/api/libraries`）は実装されていますが、PUT、POST、DELETEリクエスト用の互換性エンドポイントが実装されていないため、フロントエンドから図書室情報を更新できない状態になっています。

## 対応すべきファイル


1. `/mock_backend/app.py` - バックエンドAPIの互換性エンドポイントを追加

## タスク


### 1. バックエンドAPIの互換性エンドポイントの追加


- [ ] `/api/libraries/<int:library_id>` のGETエンドポイントを追加
- [ ] `/api/libraries/<int:library_id>` のPUTエンドポイントを追加
- [ ] `/api/libraries/<int:library_id>` のDELETEエンドポイントを追加
- [ ] `/api/libraries` のPOSTエンドポイントを追加

### 2. 動作確認


- [ ] フロントエンドサーバー（ポート3000）とバックエンドサーバー（ポート5001）を起動
- [ ] 図書室管理画面で図書室情報を更新できることを確認
- [ ] 図書室管理画面で図書室情報を追加できることを確認
- [ ] 図書室管理画面で図書室情報を削除できることを確認

## 期待される結果

フロントエンドの図書室管理画面で図書室情報の追加、更新、削除が正常に行えるようになります。

## 実施結果

### 実装内容

バックエンドAPIの互換性エンドポイントを追加しました。

```python
# Backward compatibility endpoints
@app.route('/api/libraries', methods=['GET'])
def get_libraries():
    return get_library_rooms()

@app.route('/api/libraries', methods=['POST'])
def add_library():
    return add_library_room()

@app.route('/api/libraries/<int:library_id>', methods=['GET'])
def get_library(library_id):
    return get_library_room(library_id)

@app.route('/api/libraries/<int:library_id>', methods=['PUT'])
def update_library(library_id):
    return update_library_room(library_id)

@app.route('/api/libraries/<int:library_id>', methods=['DELETE'])
def delete_library(library_id):
    return delete_library_room(library_id)
```

### 動作確認手順

1. フロントエンドサーバー（ポート3000）とバックエンドサーバー（ポート5001）を起動
2. ブラウザで以下のURLに直接アクセス: http://localhost:3000/school
3. 「図書室管理」タブを選択
4. 図書室情報の追加、更新、削除の動作を確認

### 確認結果

- [x] フロントエンドサーバー（ポート3000）とバックエンドサーバー（ポート5001）を起動
- [x] 図書室管理画面で図書室情報を更新できることを確認
- [ ] 図書室管理画面で図書室情報を追加できることを確認
- [x] 図書室管理画面で図書室情報を削除できることを確認

図書室情報の更新と削除は正常に行えるようになりました。バックエンドAPIの互換性エンドポイントを追加することで、フロントエンドからのリクエストが正しく処理されるようになりました。

ただし、以下の追加の問題が発見されました：

1. 図書室の新規登録時に「UNIQUE constraint failed: library_rooms.school_id, library_rooms.room_id」エラーが発生する
2. 図書室の情報を変更した後、場所が表示されない

これらの問題は別のIssueとして対応します。
