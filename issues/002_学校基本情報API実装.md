# Issue #002: å­¦æ ¡åŸºæœ¬æƒ…å ±ãƒ»å½¹è·æƒ…å ±APIå®Ÿè£…

## æ¦‚è¦

Issue #001ã€Œå­¦æ ¡åŸºæœ¬æƒ…å ±ç”»é¢ã®å®Ÿè£…ã€ã«å¯¾å¿œã™ã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã‚’å®Ÿè£…ã™ã‚‹ã€‚å­¦æ ¡æƒ…å ±ã¨å½¹è·æƒ…å ±ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã®é€£æºã‚’è¡Œã†ã€‚

## å®Ÿè¡Œç’°å¢ƒè¦ä»¶

**é‡è¦**: æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®Pythonå®Ÿè¡Œã¯å¿…ãšvenvç’°å¢ƒã§å®Ÿæ–½ã™ã‚‹ã“ã¨ã€‚

```bash
# venvç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆåˆå›ã®ã¿ï¼‰
cd /Users/yoshio/works/tosho-in-wariate-kun/mock_backend
python -m venv venv
source venv/bin/activate  # macOS/Linux
# ã¾ãŸã¯
# venv\Scripts\activate  # Windows

# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
python tests/test_api_schools.py
python tests/test_api_positions.py
```

## ç¾åœ¨ã®çŠ¶æ³

**ğŸ‰ å®Ÿè£…å®Œäº†**: Issue #002ã®è¦ä»¶ã¯ã™ã¹ã¦æº€ãŸã•ã‚Œã¦ã„ã¾ã™ã€‚

ç¾åœ¨ã®ãƒ¢ãƒƒã‚¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆ`/mock_backend/app.py`ï¼‰ã«ã¯ä»¥ä¸‹ã®APIãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ï¼š
- **å­¦æ ¡æƒ…å ±API** âœ… **å®Ÿè£…æ¸ˆã¿** (è¡Œ38-168)
- **å½¹è·æƒ…å ±API** âœ… **å®Ÿè£…æ¸ˆã¿** (è¡Œ170-286)
- ã‚¯ãƒ©ã‚¹æƒ…å ±API
- å›³æ›¸å®¤æƒ…å ±API
- å›³æ›¸å§”å“¡æƒ…å ±API
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é–¢é€£API

## ãƒ†ã‚¹ãƒˆçµæœ

**å…¨ãƒ†ã‚¹ãƒˆæˆåŠŸ**: 2025å¹´5æœˆ26æ—¥å®Ÿè¡Œ
- **Schools API**: 9/9ãƒ†ã‚¹ãƒˆæˆåŠŸ
- **Positions API**: 11/11ãƒ†ã‚¹ãƒˆæˆåŠŸ
- **åˆè¨ˆ**: 20/20ãƒ†ã‚¹ãƒˆæˆåŠŸ

```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œçµæœ
python tests/test_api_schools.py     # 9 tests - OK
python tests/test_api_positions.py   # 11 tests - OK
python -m pytest tests/test_api_schools.py tests/test_api_positions.py -v  # 20 passed
```

## å¤‰æ›´å†…å®¹

### æ›´æ–°ãƒ•ã‚¡ã‚¤ãƒ«

1. **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰**
   - `/mock_backend/app.py` - å­¦æ ¡æƒ…å ±ã¨å½¹è·æƒ…å ±ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ 

2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ**
   - `/mock_backend/db_setup.py` - å¿…è¦ã«å¿œã˜ã¦ã‚¹ã‚­ãƒ¼ãƒã®æ›´æ–°
   - `/mock_backend/init_database.py` - åˆæœŸãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ 

3. **ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰**
   - `/mock_backend/test_api.py` - æ–°ã—ã„APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆè¿½åŠ 

## APIä»•æ§˜è©³ç´°

### å­¦æ ¡æƒ…å ±API

#### 1. å­¦æ ¡æƒ…å ±ã®å–å¾— (GET /api/schools)

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
[
  {
    "id": 1,
    "school_name": "ä¸­å¤®ä¸­å­¦æ ¡",
    "first_term_start": "2025-04-01",
    "first_term_end": "2025-09-30",
    "second_term_start": "2025-10-01",
    "second_term_end": "2026-03-31",
    "active": true,
    "created_at": "2025-05-25T00:00:00",
    "updated_at": "2025-05-25T00:00:00"
  }
]
```

#### 2. å­¦æ ¡æƒ…å ±ã®æ–°è¦ä½œæˆ (POST /api/schools)

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```json
{
  "school_name": "æ±éƒ¨ä¸­å­¦æ ¡",
  "first_term_start": "2025-04-01",
  "first_term_end": "2025-09-30",
  "second_term_start": "2025-10-01",
  "second_term_end": "2026-03-31",
  "active": true
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (201 Created):
```json
{
  "id": 2,
  "school_name": "æ±éƒ¨ä¸­å­¦æ ¡",
  "first_term_start": "2025-04-01",
  "first_term_end": "2025-09-30",
  "second_term_start": "2025-10-01",
  "second_term_end": "2026-03-31",
  "active": true,
  "created_at": "2025-05-26T00:00:00",
  "updated_at": "2025-05-26T00:00:00"
}
```

#### 3. å­¦æ ¡æƒ…å ±ã®æ›´æ–° (PUT /api/schools/:id)

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```json
{
  "school_name": "æ±éƒ¨ç¬¬äºŒä¸­å­¦æ ¡",
  "first_term_start": "2025-04-05",
  "active": false
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (200 OK):
```json
{
  "id": 2,
  "school_name": "æ±éƒ¨ç¬¬äºŒä¸­å­¦æ ¡",
  "first_term_start": "2025-04-05",
  "first_term_end": "2025-09-30",
  "second_term_start": "2025-10-01",
  "second_term_end": "2026-03-31",
  "active": false,
  "created_at": "2025-05-26T00:00:00",
  "updated_at": "2025-05-26T01:00:00"
}
```

### å½¹è·æƒ…å ±API

#### 1. å½¹è·ä¸€è¦§ã®å–å¾— (GET /api/positions)

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
[
  {
    "id": 1,
    "position_name": "å§”å“¡é•·",
    "description": "å›³æ›¸å§”å“¡ä¼šã®ä»£è¡¨è€…",
    "created_at": "2025-05-25T00:00:00",
    "updated_at": "2025-05-25T00:00:00"
  },
  {
    "id": 2,
    "position_name": "å‰¯å§”å“¡é•·",
    "description": "å§”å“¡é•·ã®è£œä½",
    "created_at": "2025-05-25T00:00:00",
    "updated_at": "2025-05-25T00:00:00"
  }
]
```

#### 2. ç‰¹å®šã®å½¹è·ã®å–å¾— (GET /api/positions/:id)

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```json
{
  "id": 1,
  "position_name": "å§”å“¡é•·",
  "description": "å›³æ›¸å§”å“¡ä¼šã®ä»£è¡¨è€…",
  "created_at": "2025-05-25T00:00:00",
  "updated_at": "2025-05-25T00:00:00"
}
```

#### 3. å½¹è·ã®æ–°è¦ä½œæˆ (POST /api/positions)

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```json
{
  "position_name": "æ›¸è¨˜",
  "description": "ä¼šè­°ã®è¨˜éŒ²ã‚’æ‹…å½“"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (201 Created):
```json
{
  "id": 3,
  "position_name": "æ›¸è¨˜",
  "description": "ä¼šè­°ã®è¨˜éŒ²ã‚’æ‹…å½“",
  "created_at": "2025-05-26T00:00:00",
  "updated_at": "2025-05-26T00:00:00"
}
```

#### 4. å½¹è·ã®æ›´æ–° (PUT /api/positions/:id)

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```json
{
  "description": "å›³æ›¸å§”å“¡ä¼šã®æ›¸è¨˜ã¨ã—ã¦ä¼šè­°ã®è­°äº‹éŒ²ã‚’ç®¡ç†"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (200 OK):
```json
{
  "id": 3,
  "position_name": "æ›¸è¨˜",
  "description": "å›³æ›¸å§”å“¡ä¼šã®æ›¸è¨˜ã¨ã—ã¦ä¼šè­°ã®è­°äº‹éŒ²ã‚’ç®¡ç†",
  "created_at": "2025-05-26T00:00:00",
  "updated_at": "2025-05-26T01:00:00"
}
```

#### 5. å½¹è·ã®å‰Šé™¤ (DELETE /api/positions/:id)

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹** (200 OK):
```json
{
  "message": "Position with id 3 successfully deleted"
}
```

## ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…è©³ç´°

### å­¦æ ¡æƒ…å ±APIå®Ÿè£…
```python
# --- API Endpoints for Schools ---

@app.route('/api/schools', methods=['GET'])
def get_schools():
    conn = get_db_connection()
    schools_cursor = conn.execute('SELECT * FROM schools')
    schools = [dict(row) for row in schools_cursor.fetchall()]
    conn.close()
    return jsonify(schools)

@app.route('/api/schools', methods=['POST'])
def add_school():
    new_school_data = request.json
    if not new_school_data or 'school_name' not in new_school_data:
        return jsonify({"error": "Missing school_name in request body"}), 400

    school_name = new_school_data['school_name']
    first_term_start = new_school_data.get('first_term_start')
    first_term_end = new_school_data.get('first_term_end')
    second_term_start = new_school_data.get('second_term_start')
    second_term_end = new_school_data.get('second_term_end')
    active = new_school_data.get('active', True)

    conn = get_db_connection()
    cursor = conn.cursor()
    try:
        cursor.execute('''
            INSERT INTO schools (
                school_name, first_term_start, first_term_end, 
                second_term_start, second_term_end, active
            ) VALUES (?, ?, ?, ?, ?, ?)
        ''', (school_name, first_term_start, first_term_end, 
              second_term_start, second_term_end, active))
        conn.commit()
        new_school_id = cursor.lastrowid
        
        # Get the created school with timestamps
        cursor.execute('SELECT * FROM schools WHERE id = ?', (new_school_id,))
        created_school = dict(cursor.fetchone())
    except sqlite3.IntegrityError:
        conn.close()
        return jsonify({"error": "Failed to create school, possibly due to constraint violation"}), 409
    finally:
        conn.close()

    return jsonify(created_school), 201

@app.route('/api/schools/<int:school_id>', methods=['PUT'])
def update_school(school_id):
    update_data = request.json
    if not update_data:
        return jsonify({"error": "Request body cannot be empty"}), 400

    conn = get_db_connection()
    cursor = conn.cursor()

    # Check if school exists
    cursor.execute('SELECT * FROM schools WHERE id = ?', (school_id,))
    school = cursor.fetchone()
    if not school:
        conn.close()
        return jsonify({"error": "School not found"}), 404

    # Prepare update fields and values
    fields_to_update = []
    values = []
    
    for field in ['school_name', 'first_term_start', 'first_term_end', 
                  'second_term_start', 'second_term_end', 'active']:
        if field in update_data:
            fields_to_update.append(f"{field} = ?")
            values.append(update_data[field])
    
    if not fields_to_update:
        conn.close()
        return jsonify({"error": "No valid fields to update provided"}), 400
    
    # Add updated_at field
    fields_to_update.append("updated_at = CURRENT_TIMESTAMP")
    
    # Create SQL query
    sql = f"UPDATE schools SET {', '.join(fields_to_update)} WHERE id = ?"
    values.append(school_id)
    
    try:
        cursor.execute(sql, values)
        conn.commit()
        
        # Get the updated school
        cursor.execute('SELECT * FROM schools WHERE id = ?', (school_id,))
        updated_school = dict(cursor.fetchone())
    except sqlite3.Error as e:
        conn.close()
        return jsonify({"error": f"Failed to update school: {str(e)}"}), 500
    finally:
        conn.close()
        
    return jsonify(updated_school)
```

### å½¹è·æƒ…å ±APIå®Ÿè£…
```python
# --- API Endpoints for Positions ---

@app.route('/api/positions', methods=['GET'])
def get_positions():
    conn = get_db_connection()
    positions_cursor = conn.execute('SELECT * FROM positions')
    positions = [dict(row) for row in positions_cursor.fetchall()]
    conn.close()
    return jsonify(positions)

@app.route('/api/positions/<int:position_id>', methods=['GET'])
def get_position(position_id):
    conn = get_db_connection()
    cursor = conn.cursor()
    cursor.execute('SELECT * FROM positions WHERE id = ?', (position_id,))
    position = cursor.fetchone()
    conn.close()
    
    if position is None:
        return jsonify({"error": "Position not found"}), 404
        
    return jsonify(dict(position))

@app.route('/api/positions', methods=['POST'])
def add_position():
    new_position_data = request.json
    if not new_position_data or 'position_name' not in new_position_data:
        return jsonify({"error": "Missing position_name in request body"}), 400

    position_name = new_position_data['position_name']
    description = new_position_data.get('description')

    conn = get_db_connection()
    cursor = conn.cursor()
    try:
        cursor.execute('INSERT INTO positions (position_name, description) VALUES (?, ?)', 
                      (position_name, description))
        conn.commit()
        new_position_id = cursor.lastrowid
        
        # Get the created position with timestamps
        cursor.execute('SELECT * FROM positions WHERE id = ?', (new_position_id,))
        created_position = dict(cursor.fetchone())
    except sqlite3.IntegrityError:
        conn.close()
        return jsonify({"error": "Failed to create position, possibly due to constraint violation"}), 409
    finally:
        conn.close()

    return jsonify(created_position), 201

@app.route('/api/positions/<int:position_id>', methods=['PUT'])
def update_position(position_id):
    update_data = request.json
    if not update_data:
        return jsonify({"error": "Request body cannot be empty"}), 400

    conn = get_db_connection()
    cursor = conn.cursor()

    # Check if position exists
    cursor.execute('SELECT * FROM positions WHERE id = ?', (position_id,))
    position = cursor.fetchone()
    if not position:
        conn.close()
        return jsonify({"error": "Position not found"}), 404

    # Prepare update fields and values
    fields_to_update = []
    values = []
    
    for field in ['position_name', 'description']:
        if field in update_data:
            fields_to_update.append(f"{field} = ?")
            values.append(update_data[field])
    
    if not fields_to_update:
        conn.close()
        return jsonify({"error": "No valid fields to update provided"}), 400
    
    # Add updated_at field
    fields_to_update.append("updated_at = CURRENT_TIMESTAMP")
    
    # Create SQL query
    sql = f"UPDATE positions SET {', '.join(fields_to_update)} WHERE id = ?"
    values.append(position_id)
    
    try:
        cursor.execute(sql, values)
        conn.commit()
        
        # Get the updated position
        cursor.execute('SELECT * FROM positions WHERE id = ?', (position_id,))
        updated_position = dict(cursor.fetchone())
    except sqlite3.Error as e:
        conn.close()
        return jsonify({"error": f"Failed to update position: {str(e)}"}), 500
    finally:
        conn.close()
        
    return jsonify(updated_position)

@app.route('/api/positions/<int:position_id>', methods=['DELETE'])
def delete_position(position_id):
    conn = get_db_connection()
    cursor = conn.cursor()
    
    # Check if position exists
    cursor.execute('SELECT * FROM positions WHERE id = ?', (position_id,))
    position = cursor.fetchone()
    if not position:
        conn.close()
        return jsonify({"error": "Position not found"}), 404
    
    # Check if the position is referenced by any committee members
    cursor.execute('SELECT COUNT(*) FROM committee_members WHERE position_id = ?', (position_id,))
    count = cursor.fetchone()[0]
    if count > 0:
        conn.close()
        return jsonify({"error": "Cannot delete position as it is assigned to committee members"}), 409
    
    # Delete the position
    try:
        cursor.execute('DELETE FROM positions WHERE id = ?', (position_id,))
        conn.commit()
    except sqlite3.Error as e:
        conn.close()
        return jsonify({"error": f"Failed to delete position: {str(e)}"}), 500
    finally:
        conn.close()
    
    return jsonify({"message": f"Position with id {position_id} successfully deleted"})
```

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ›´æ–°

æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦æ›´æ–°ã—ã¾ã™ã€‚`db_setup.py`ã«ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã‚’è¿½åŠ ãƒ»ç¢ºèªã—ã¾ã™ï¼š

```python
# schools ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ
cursor.execute('''
CREATE TABLE IF NOT EXISTS schools (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    school_name TEXT NOT NULL UNIQUE,
    first_term_start DATE,
    first_term_end DATE,
    second_term_start DATE,
    second_term_end DATE,
    active BOOLEAN NOT NULL DEFAULT TRUE,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
)
''')

# positions ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ
cursor.execute('''
CREATE TABLE IF NOT EXISTS positions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    position_name TEXT NOT NULL UNIQUE,
    description TEXT,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
)
''')
```

## åˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥

`init_database.py`ã«ä»¥ä¸‹ã®åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```python
# å­¦æ ¡ãƒ†ãƒ¼ãƒ–ãƒ«åˆæœŸãƒ‡ãƒ¼ã‚¿
cursor.execute('''
INSERT INTO schools (school_name, first_term_start, first_term_end, second_term_start, second_term_end)
VALUES ('ä¸­å¤®ä¸­å­¦æ ¡', '2025-04-01', '2025-09-30', '2025-10-01', '2026-03-31')
''')

# å½¹è·ãƒ†ãƒ¼ãƒ–ãƒ«åˆæœŸãƒ‡ãƒ¼ã‚¿
cursor.execute('''
INSERT INTO positions (position_name, description) VALUES 
('å§”å“¡é•·', 'å›³æ›¸å§”å“¡ä¼šã®ä»£è¡¨è€…'),
('å‰¯å§”å“¡é•·', 'å§”å“¡é•·ã®è£œä½'),
('æ›¸è¨˜', 'æ›¸è¨˜')
''')
```

## ãƒ†ã‚¹ãƒˆä»•æ§˜

`test_api.py`ã«ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```python
# å­¦æ ¡æƒ…å ±APIã®ãƒ†ã‚¹ãƒˆ
def test_get_schools():
    response = client.get('/api/schools')
    assert response.status_code == 200
    data = response.json
    assert isinstance(data, list)
    if len(data) > 0:
        assert 'school_name' in data[0]

def test_create_school():
    new_school = {
        "school_name": "ãƒ†ã‚¹ãƒˆä¸­å­¦æ ¡",
        "first_term_start": "2025-04-01",
        "first_term_end": "2025-09-30"
    }
    response = client.post('/api/schools', json=new_school)
    assert response.status_code == 201
    data = response.json
    assert data['school_name'] == new_school['school_name']
    assert 'id' in data

def test_update_school():
    # æœ€åˆã«å­¦æ ¡ã‚’å–å¾—
    schools_response = client.get('/api/schools')
    schools_data = schools_response.json
    if len(schools_data) == 0:
        # ãƒ†ã‚¹ãƒˆå­¦æ ¡ã‚’ä½œæˆ
        test_create_school()
        schools_response = client.get('/api/schools')
        schools_data = schools_response.json
    
    school_id = schools_data[0]['id']
    update_data = {
        "school_name": "æ›´æ–°ãƒ†ã‚¹ãƒˆä¸­å­¦æ ¡"
    }
    response = client.put(f'/api/schools/{school_id}', json=update_data)
    assert response.status_code == 200
    data = response.json
    assert data['school_name'] == update_data['school_name']

# å½¹è·æƒ…å ±APIã®ãƒ†ã‚¹ãƒˆ
def test_get_positions():
    response = client.get('/api/positions')
    assert response.status_code == 200
    data = response.json
    assert isinstance(data, list)
    if len(data) > 0:
        assert 'position_name' in data[0]

def test_get_position_by_id():
    # æœ€åˆã«å½¹è·ä¸€è¦§ã‚’å–å¾—
    positions_response = client.get('/api/positions')
    positions_data = positions_response.json
    if len(positions_data) == 0:
        # ãƒ†ã‚¹ãƒˆå½¹è·ã‚’ä½œæˆ
        test_create_position()
        positions_response = client.get('/api/positions')
        positions_data = positions_response.json
    
    position_id = positions_data[0]['id']
    response = client.get(f'/api/positions/{position_id}')
    assert response.status_code == 200
    data = response.json
    assert data['id'] == position_id

def test_create_position():
    new_position = {
        "position_name": "ãƒ†ã‚¹ãƒˆå½¹è·",
        "description": "ãƒ†ã‚¹ãƒˆç”¨ã®å½¹è·èª¬æ˜"
    }
    response = client.post('/api/positions', json=new_position)
    assert response.status_code == 201
    data = response.json
    assert data['position_name'] == new_position['position_name']
    assert 'id' in data

def test_update_position():
    # æœ€åˆã«å½¹è·ã‚’å–å¾—
    positions_response = client.get('/api/positions')
    positions_data = positions_response.json
    if len(positions_data) == 0:
        # ãƒ†ã‚¹ãƒˆå½¹è·ã‚’ä½œæˆ
        test_create_position()
        positions_response = client.get('/api/positions')
        positions_data = positions_response.json
    
    position_id = positions_data[0]['id']
    update_data = {
        "description": "æ›´æ–°ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆèª¬æ˜"
    }
    response = client.put(f'/api/positions/{position_id}', json=update_data)
    assert response.status_code == 200
    data = response.json
    assert data['description'] == update_data['description']

def test_delete_position():
    # ãƒ†ã‚¹ãƒˆç”¨ã®å½¹è·ã‚’ä½œæˆ
    new_position = {
        "position_name": "å‰Šé™¤ãƒ†ã‚¹ãƒˆå½¹è·",
        "description": "å‰Šé™¤ãƒ†ã‚¹ãƒˆç”¨ã®å½¹è·"
    }
    create_response = client.post('/api/positions', json=new_position)
    position_id = create_response.json['id']
    
    # ä½œæˆã—ãŸå½¹è·ã‚’å‰Šé™¤
    response = client.delete(f'/api/positions/{position_id}')
    assert response.status_code == 200
    data = response.json
    assert "successfully deleted" in data["message"]
    
    # å‰Šé™¤ã—ãŸå½¹è·ãŒå–å¾—ã§ããªã„ã“ã¨ã‚’ç¢ºèª
    get_response = client.get(f'/api/positions/{position_id}')
    assert get_response.status_code == 404
```

## å®Œäº†æ¡ä»¶

1. å­¦æ ¡æƒ…å ±APIã®å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå®Ÿè£…ã•ã‚Œã€æ­£å¸¸ã«å‹•ä½œã™ã‚‹
2. å½¹è·æƒ…å ±APIã®å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒå®Ÿè£…ã•ã‚Œã€æ­£å¸¸ã«å‹•ä½œã™ã‚‹
3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒãŒæ›´æ–°ã•ã‚Œã€åˆæœŸãƒ‡ãƒ¼ã‚¿ãŒæŠ•å…¥ã•ã‚Œã¦ã„ã‚‹
4. ã™ã¹ã¦ã®APIãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹

## é–¢é€£Issue

- Issue #001: å­¦æ ¡åŸºæœ¬æƒ…å ±ç”»é¢ã®å®Ÿè£…ï¼ˆå›³æ›¸å®¤ç®¡ç†ãƒ»ã‚¯ãƒ©ã‚¹ç®¡ç†ã‚’å«ã‚€ï¼‰
