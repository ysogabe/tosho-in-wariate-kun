# Issue #023: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ã®å®Ÿè£…

**Priority**: High  
**Difficulty**: Intermediate  
**Estimated Time**: 5-7 hours  
**Type**: Frontend  
**Labels**: frontend, pages, dashboard, analytics

## Description

ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ¡ã‚¤ãƒ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ã‚’å®Ÿè£…ã—ã¾ã™ã€‚å½“ç•ªè¡¨ã®çŠ¶æ³ã€çµ±è¨ˆæƒ…å ±ã€æœ€è¿‘ã®æ´»å‹•ã€ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’çµ±åˆã—ãŸæƒ…å ±ç®¡ç†ã®ä¸­å¿ƒã¨ãªã‚‹ãƒšãƒ¼ã‚¸ã‚’æä¾›ã—ã¾ã™ã€‚

## Background

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­è¨ˆæ›¸ã§å®šç¾©ã•ã‚ŒãŸãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”»é¢ã®è¦ä»¶ã«åŸºã¥ãã€æ•™å“¡ãŒä¸€ç›®ã§ã‚·ã‚¹ãƒ†ãƒ ã®çŠ¶æ³ã‚’æŠŠæ¡ã§ãã€ä¸»è¦ãªæ“ä½œã«ã™ãã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹åŠ¹ç‡çš„ãªãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

## Acceptance Criteria

- [ ] ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] çµ±è¨ˆæƒ…å ±ã®è¡¨ç¤ºãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] **ä»Šæ—¥ã®å½“ç•ªè¡¨ç¤ºæ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹** (æ–°è¦è¿½åŠ )
- [ ] **é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨ç¤ºæ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹** (æ–°è¦è¿½åŠ )
- [ ] å½“ç•ªè¡¨ã®çŠ¶æ³è¡¨ç¤ºãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] æœ€è¿‘ã®æ´»å‹•è¡¨ç¤ºãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°æ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹

## æ–°æ©Ÿèƒ½: ç”»é¢æ§‹æˆæ¡ˆ

### ğŸ“‹ ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ (ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ )

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - å›³æ›¸å§”å“¡å½“ç•ªã‚·ã‚¹ãƒ†ãƒ ã®æ¦‚è¦                                      â”‚
â”‚                                                     [æ›´æ–°] ãƒœã‚¿ãƒ³              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çµ±è¨ˆã‚«ãƒ¼ãƒ‰ï¼ˆæ—¢å­˜ï¼‰                                                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                                          â”‚
â”‚ â”‚ğŸ‘¥ 12â”‚ â”‚ğŸ« 6 â”‚ â”‚ğŸ“… 48â”‚ â”‚ğŸ“– 2 â”‚                                          â”‚
â”‚ â”‚å§”å“¡æ•°â”‚ â”‚ã‚¯ãƒ©ã‚¹â”‚ â”‚å½“ç•ªæ•°â”‚ â”‚å›³æ›¸å®¤â”‚                                          â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸŒŸ ä»Šæ—¥ã®å½“ç•ª (æ–°è¦è¿½åŠ )                            ğŸ“… ä»Šæ—¥: 7æœˆ8æ—¥(æœˆ)       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“š å›³æ›¸å®¤1                     ğŸ“š å›³æ›¸å®¤2                              â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚ â”‚
â”‚ â”‚ â”‚ ğŸ‘¤ ç”°ä¸­ èŠ±å­     â”‚             â”‚ ğŸ‘¤ ä½è—¤ å¤ªéƒ     â”‚                   â”‚ â”‚
â”‚ â”‚ â”‚ 5å¹´2çµ„          â”‚             â”‚ 6å¹´1çµ„          â”‚                   â”‚ â”‚
â”‚ â”‚ â”‚ â° 8:15-8:30   â”‚             â”‚ â° 12:25-12:40 â”‚                   â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‹ ä»Šé€±ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« (æ–°è¦è¿½åŠ )                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚      â”‚ æœˆ   â”‚ ç«   â”‚ æ°´   â”‚ æœ¨   â”‚ é‡‘              â”‚  [ğŸ“Šè©³ç´°è¡¨ç¤º]     â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚ â”‚
â”‚ â”‚å›³æ›¸å®¤1â”‚ç”°ä¸­â˜… â”‚å±±ç”°  â”‚éˆ´æœ¨  â”‚æ¾æœ¬  â”‚é«˜æ©‹            â”‚  [ğŸ–¨ï¸å°åˆ·]       â”‚ â”‚
â”‚ â”‚      â”‚5-2   â”‚6-1   â”‚5-1   â”‚6-2   â”‚5-3            â”‚                    â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚ â”‚
â”‚ â”‚å›³æ›¸å®¤2â”‚ä½è—¤  â”‚ä¼Šè—¤  â”‚æ¸¡è¾º  â”‚å°æ—  â”‚åŠ è—¤            â”‚                    â”‚ â”‚
â”‚ â”‚      â”‚6-1   â”‚5-2   â”‚6-3   â”‚5-1   â”‚6-2            â”‚                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â˜…å°: ä»Šæ—¥ã®å½“ç•ª                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å½“ç•ªè¡¨ã®çŠ¶æ³ (æ—¢å­˜)                         â”‚ ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ (æ—¢å­˜)        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ âœ… å‰æœŸãƒ»å¾ŒæœŸã®å½“ç•ªè¡¨ãŒä½œæˆæ¸ˆã¿        â”‚    â”‚ â”‚ â• å›³æ›¸å§”å“¡ã‚’è¿½åŠ            â”‚â”‚
â”‚ â”‚                                   â”‚    â”‚ â”‚ ğŸ« ã‚¯ãƒ©ã‚¹ç®¡ç†               â”‚â”‚
â”‚ â”‚ å‰æœŸ: ä½œæˆæ¸ˆã¿  â”‚ å¾ŒæœŸ: ä½œæˆæ¸ˆã¿    â”‚    â”‚ â”‚ ğŸ“Š å½“ç•ªè¡¨ã‚’è¦‹ã‚‹             â”‚â”‚
â”‚ â”‚ 24ä»¶ã®å½“ç•ª     â”‚ 24ä»¶ã®å½“ç•ª       â”‚    â”‚ â”‚ ğŸ’¾ ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›               â”‚â”‚
â”‚ â”‚                                   â”‚    â”‚ â”‚ âš™ï¸  ã‚·ã‚¹ãƒ†ãƒ è¨­å®š             â”‚â”‚
â”‚ â”‚ [ğŸ“…å½“ç•ªè¡¨ç®¡ç†] [â•æ–°è¦ç”Ÿæˆ]         â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è©³ç´°æƒ…å ± (æ—¢å­˜)                                                              â”‚
â”‚ [æ¦‚è¦] [åˆ†æ] [æœ€è¿‘ã®æ´»å‹•] ã‚¿ãƒ–                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¯ æ–°æ©Ÿèƒ½ã®è©³ç´°ä»•æ§˜

#### 1. ä»Šæ—¥ã®å½“ç•ªè¡¨ç¤º (TodayDuties Component)

**è¡¨ç¤ºä½ç½®**: çµ±è¨ˆã‚«ãƒ¼ãƒ‰ã®ç›´ä¸‹
**æ©Ÿèƒ½è¦ä»¶**:
- ç¾åœ¨ã®æ—¥ä»˜ã¨æ›œæ—¥ã‚’è¡¨ç¤º
- å„å›³æ›¸å®¤ã®å½“ç•ªæƒ…å ±ï¼ˆåå‰ã€ã‚¯ãƒ©ã‚¹ã€æ™‚é–“å¸¯ï¼‰
- åœŸæ—¥ãƒ»ç¥æ—¥ã¯ã€Œä»Šæ—¥ã¯å½“ç•ªãŒã‚ã‚Šã¾ã›ã‚“ã€è¡¨ç¤º
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ—¥ä»˜æ›´æ–°ï¼ˆæ—¥ä»˜ãŒå¤‰ã‚ã£ãŸã‚‰è‡ªå‹•æ›´æ–°ï¼‰

**APIä»•æ§˜**: `GET /api/dashboard/today-duties`
```typescript
interface TodayDuty {
  roomId: string
  roomName: string
  student: {
    name: string
    class: {
      year: number
      name: string
    }
  }
  timeSlot: string
  period: 'MORNING' | 'LUNCH' | 'AFTER_SCHOOL'
}

interface TodayDutiesResponse {
  date: string  // YYYY-MM-DD
  dayOfWeek: string  // 'monday' | 'tuesday' | ...
  isWeekend: boolean
  duties: TodayDuty[]
}
```

#### 2. é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨ç¤º (WeeklySchedule Component)

**è¡¨ç¤ºä½ç½®**: ä»Šæ—¥ã®å½“ç•ªã®ç›´ä¸‹
**æ©Ÿèƒ½è¦ä»¶**:
- æœˆæ›œã€œé‡‘æ›œã®5æ—¥é–“è¡¨ç¤ºï¼ˆã‚³ãƒ³ãƒ‘ã‚¯ãƒˆç‰ˆï¼‰
- å„å›³æ›¸å®¤ã®å½“ç•ªã‚’åå‰ã¨ã‚¯ãƒ©ã‚¹ã§è¡¨ç¤º
- ä»Šæ—¥ã®å½“ç•ªã‚’â˜…å°ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- [è©³ç´°è¡¨ç¤º]ãƒœã‚¿ãƒ³ã§å®Œå…¨ãªå½“ç•ªè¡¨ã¸é·ç§»
- [å°åˆ·]ãƒœã‚¿ãƒ³ã§é€±é–“è¡¨ã‚’PDFå°åˆ·

**ãƒ‡ãƒ¼ã‚¿ä»•æ§˜**: æ—¢å­˜ã®Schedule APIã‚’æ‹¡å¼µåˆ©ç”¨

### ğŸ”„ TDDå®Ÿè£…ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

#### Phase 1: Red (å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ã)
1. `/api/dashboard/today-duties` APIã®ãƒ†ã‚¹ãƒˆä½œæˆ
2. `TodayDuties` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆä½œæˆ
3. `WeeklySchedule` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆä½œæˆ
4. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸çµ±åˆãƒ†ã‚¹ãƒˆä½œæˆ

#### Phase 2: Green (ãƒ†ã‚¹ãƒˆã‚’é€šã™æœ€å°é™ã®å®Ÿè£…)
1. API endpointå®Ÿè£…
2. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŸºæœ¬å®Ÿè£…
3. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸çµ±åˆ

#### Phase 3: Refactor (å“è³ªå‘ä¸Š)
1. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
2. ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ”¹å–„
3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–
4. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œå®Œæˆ

## Implementation Guidelines

### Getting Started

1. Issue #018ï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†ãƒšãƒ¼ã‚¸ï¼‰ãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
2. Issue #019ï¼ˆã‚¯ãƒ©ã‚¹ç®¡ç†ãƒšãƒ¼ã‚¸ï¼‰ãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
3. Issue #020ï¼ˆå›³æ›¸å§”å“¡ç®¡ç†ãƒšãƒ¼ã‚¸ï¼‰ãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
4. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç†è§£

### Main Implementation

#### 1. Dashboard Page

##### src/app/dashboard/page.tsx

```typescript
'use client'

import { useState, useMemo } from 'react'
import useSWR from 'swr'
import Link from 'next/link'
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'
import { Button } from '@/components/ui/button'
import { Badge } from '@/components/ui/badge'
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'
import { Alert, AlertDescription } from '@/components/ui/alert'
import { PageLayout } from '@/components/layout/page-layout'
import { LoadingSpinner } from '@/components/common/loading-spinner'
import {
  Calendar,
  Users,
  Building,
  BarChart3,
  Plus,
  RefreshCw,
  TrendingUp,
  AlertCircle,
  CheckCircle,
  Clock,
  ArrowRight,
  BookOpen,
  Settings,
  Download
} from 'lucide-react'
import { toast } from 'sonner'

interface DashboardStats {
  students: {
    total: number
    active: number
    grade5: number
    grade6: number
  }
  classes: {
    total: number
    withStudents: number
  }
  schedules: {
    firstTerm: {
      exists: boolean
      assignmentCount: number
      lastGenerated: string | null
    }
    secondTerm: {
      exists: boolean
      assignmentCount: number
      lastGenerated: string | null
    }
  }
  rooms: {
    total: number
    active: number
  }
}

interface RecentActivity {
  id: string
  type: 'student_created' | 'class_created' | 'schedule_generated' | 'student_updated'
  description: string
  timestamp: string
  user?: string
}

export default function DashboardPage() {
  const [activeTab, setActiveTab] = useState('overview')

  // çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®å–å¾—
  const {
    data: statsData,
    error: statsError,
    isLoading: statsLoading,
    mutate: mutateStats
  } = useSWR('/api/dashboard/stats', async (url: string) => {
    const response = await fetch(url)
    if (!response.ok) {
      throw new Error('Failed to fetch dashboard stats')
    }
    return response.json()
  })

  // æœ€è¿‘ã®æ´»å‹•ã®å–å¾—
  const {
    data: activitiesData,
    isLoading: activitiesLoading
  } = useSWR('/api/dashboard/activities', async (url: string) => {
    const response = await fetch(url)
    if (!response.ok) {
      throw new Error('Failed to fetch recent activities')
    }
    return response.json()
  })

  const stats = statsData?.data as DashboardStats
  const activities = activitiesData?.data?.activities as RecentActivity[] || []

  // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«çŠ¶æ³ã®åˆ†æ
  const scheduleStatus = useMemo(() => {
    if (!stats) return { status: 'loading', message: '' }

    const { firstTerm, secondTerm } = stats.schedules

    if (!firstTerm.exists && !secondTerm.exists) {
      return {
        status: 'empty',
        message: 'å½“ç•ªè¡¨ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“',
        action: 'ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”ŸæˆãŒå¿…è¦ã§ã™'
      }
    }

    if (firstTerm.exists && !secondTerm.exists) {
      return {
        status: 'partial',
        message: 'å‰æœŸã®å½“ç•ªè¡¨ã®ã¿ä½œæˆæ¸ˆã¿',
        action: 'å¾ŒæœŸã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”Ÿæˆã‚’æ¤œè¨ã—ã¦ãã ã•ã„'
      }
    }

    if (firstTerm.exists && secondTerm.exists) {
      return {
        status: 'complete',
        message: 'å‰æœŸãƒ»å¾ŒæœŸã®å½“ç•ªè¡¨ãŒä½œæˆæ¸ˆã¿',
        action: ''
      }
    }

    return { status: 'unknown', message: '', action: '' }
  }, [stats])

  const handleRefreshData = async () => {
    try {
      await mutateStats()
      toast.success('ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã—ã¾ã—ãŸ')
    } catch (error) {
      toast.error('ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ')
    }
  }

  if (statsError) {
    return (
      <PageLayout title="ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰" description="ã‚·ã‚¹ãƒ†ãƒ ã®æ¦‚è¦">
        <Alert variant="destructive">
          <AlertCircle className="h-4 w-4" />
          <AlertDescription>
            ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚
          </AlertDescription>
        </Alert>
      </PageLayout>
    )
  }

  return (
    <PageLayout
      title="ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰"
      description="å›³æ›¸å§”å“¡å½“ç•ªã‚·ã‚¹ãƒ†ãƒ ã®æ¦‚è¦"
      actions={
        <Button variant="outline" onClick={handleRefreshData}>
          <RefreshCw className="mr-2 h-4 w-4" />
          æ›´æ–°
        </Button>
      }
    >
      <div className="space-y-6">
        {/* ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ã‚µãƒãƒªãƒ¼ */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <Card>
            <CardContent className="p-4">
              <div className="flex items-center gap-3">
                <div className="p-2 bg-blue-100 rounded-lg">
                  <Users className="h-5 w-5 text-blue-600" />
                </div>
                <div>
                  <div className="text-2xl font-bold">
                    {statsLoading ? '---' : stats?.students.total || 0}
                  </div>
                  <p className="text-sm text-muted-foreground">å›³æ›¸å§”å“¡æ•°</p>
                  {stats && (
                    <p className="text-xs text-green-600">
                      {stats.students.active}åãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–
                    </p>
                  )}
                </div>
              </div>
            </CardContent>
          </Card>

          <Card>
            <CardContent className="p-4">
              <div className="flex items-center gap-3">
                <div className="p-2 bg-green-100 rounded-lg">
                  <Building className="h-5 w-5 text-green-600" />
                </div>
                <div>
                  <div className="text-2xl font-bold">
                    {statsLoading ? '---' : stats?.classes.total || 0}
                  </div>
                  <p className="text-sm text-muted-foreground">ã‚¯ãƒ©ã‚¹æ•°</p>
                  {stats && (
                    <p className="text-xs text-green-600">
                      {stats.classes.withStudents}ã‚¯ãƒ©ã‚¹ã«å§”å“¡åœ¨ç±
                    </p>
                  )}
                </div>
              </div>
            </CardContent>
          </Card>

          <Card>
            <CardContent className="p-4">
              <div className="flex items-center gap-3">
                <div className="p-2 bg-purple-100 rounded-lg">
                  <Calendar className="h-5 w-5 text-purple-600" />
                </div>
                <div>
                  <div className="text-2xl font-bold">
                    {statsLoading ? '---' :
                      (stats?.schedules.firstTerm.assignmentCount || 0) +
                      (stats?.schedules.secondTerm.assignmentCount || 0)
                    }
                  </div>
                  <p className="text-sm text-muted-foreground">ç·å½“ç•ªæ•°</p>
                  {scheduleStatus.status === 'complete' && (
                    <p className="text-xs text-green-600">å®Œäº†</p>
                  )}
                </div>
              </div>
            </CardContent>
          </Card>

          <Card>
            <CardContent className="p-4">
              <div className="flex items-center gap-3">
                <div className="p-2 bg-orange-100 rounded-lg">
                  <BookOpen className="h-5 w-5 text-orange-600" />
                </div>
                <div>
                  <div className="text-2xl font-bold">
                    {statsLoading ? '---' : stats?.rooms.active || 0}
                  </div>
                  <p className="text-sm text-muted-foreground">å›³æ›¸å®¤æ•°</p>
                  {stats && (
                    <p className="text-xs text-muted-foreground">
                      {stats.rooms.total}å®¤ä¸­{stats.rooms.active}å®¤ç¨¼åƒ
                    </p>
                  )}
                </div>
              </div>
            </CardContent>
          </Card>
        </div>

        {/* ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«çŠ¶æ³ã¨ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */}
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
          {/* ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«çŠ¶æ³ */}
          <Card className="lg:col-span-2">
            <CardHeader>
              <CardTitle className="flex items-center gap-2">
                <Calendar className="h-5 w-5" />
                å½“ç•ªè¡¨ã®çŠ¶æ³
              </CardTitle>
            </CardHeader>
            <CardContent>
              {statsLoading ? (
                <div className="flex items-center justify-center py-8">
                  <LoadingSpinner size="lg" text="çŠ¶æ³ã‚’ç¢ºèªä¸­..." />
                </div>
              ) : (
                <div className="space-y-4">
                  <div className="flex items-center gap-3 p-3 rounded-lg border">
                    {scheduleStatus.status === 'complete' ? (
                      <CheckCircle className="h-5 w-5 text-green-600" />
                    ) : scheduleStatus.status === 'partial' ? (
                      <Clock className="h-5 w-5 text-yellow-600" />
                    ) : (
                      <AlertCircle className="h-5 w-5 text-red-600" />
                    )}
                    <div className="flex-1">
                      <p className="font-medium">{scheduleStatus.message}</p>
                      {scheduleStatus.action && (
                        <p className="text-sm text-muted-foreground">{scheduleStatus.action}</p>
                      )}
                    </div>
                  </div>

                  <div className="grid grid-cols-2 gap-4">
                    <div className="p-3 rounded-lg bg-muted/30">
                      <div className="flex items-center justify-between mb-2">
                        <h4 className="font-medium">å‰æœŸ</h4>
                        <Badge variant={stats?.schedules.firstTerm.exists ? 'default' : 'secondary'}>
                          {stats?.schedules.firstTerm.exists ? 'ä½œæˆæ¸ˆã¿' : 'æœªä½œæˆ'}
                        </Badge>
                      </div>
                      {stats?.schedules.firstTerm.exists && (
                        <p className="text-sm text-muted-foreground">
                          {stats.schedules.firstTerm.assignmentCount}ä»¶ã®å½“ç•ª
                        </p>
                      )}
                    </div>

                    <div className="p-3 rounded-lg bg-muted/30">
                      <div className="flex items-center justify-between mb-2">
                        <h4 className="font-medium">å¾ŒæœŸ</h4>
                        <Badge variant={stats?.schedules.secondTerm.exists ? 'default' : 'secondary'}>
                          {stats?.schedules.secondTerm.exists ? 'ä½œæˆæ¸ˆã¿' : 'æœªä½œæˆ'}
                        </Badge>
                      </div>
                      {stats?.schedules.secondTerm.exists && (
                        <p className="text-sm text-muted-foreground">
                          {stats.schedules.secondTerm.assignmentCount}ä»¶ã®å½“ç•ª
                        </p>
                      )}
                    </div>
                  </div>

                  <div className="flex gap-2 pt-2">
                    <Button asChild size="sm">
                      <Link href="/admin/schedules">
                        <Calendar className="mr-2 h-4 w-4" />
                        å½“ç•ªè¡¨ç®¡ç†
                      </Link>
                    </Button>
                    <Button variant="outline" size="sm" asChild>
                      <Link href="/admin/schedules?action=generate">
                        <Plus className="mr-2 h-4 w-4" />
                        æ–°è¦ç”Ÿæˆ
                      </Link>
                    </Button>
                  </div>
                </div>
              )}
            </CardContent>
          </Card>

          {/* ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */}
          <Card>
            <CardHeader>
              <CardTitle>ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</CardTitle>
            </CardHeader>
            <CardContent>
              <div className="space-y-3">
                <Button asChild className="w-full justify-start">
                  <Link href="/admin/students">
                    <Plus className="mr-2 h-4 w-4" />
                    å›³æ›¸å§”å“¡ã‚’è¿½åŠ 
                  </Link>
                </Button>

                <Button asChild variant="outline" className="w-full justify-start">
                  <Link href="/admin/classes">
                    <Building className="mr-2 h-4 w-4" />
                    ã‚¯ãƒ©ã‚¹ç®¡ç†
                  </Link>
                </Button>

                <Button asChild variant="outline" className="w-full justify-start">
                  <Link href="/admin/schedules?format=grid">
                    <BarChart3 className="mr-2 h-4 w-4" />
                    å½“ç•ªè¡¨ã‚’è¦‹ã‚‹
                  </Link>
                </Button>

                <Button asChild variant="outline" className="w-full justify-start">
                  <Link href="/admin/schedules/export">
                    <Download className="mr-2 h-4 w-4" />
                    ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›
                  </Link>
                </Button>

                <Button asChild variant="ghost" className="w-full justify-start">
                  <Link href="/admin/settings">
                    <Settings className="mr-2 h-4 w-4" />
                    ã‚·ã‚¹ãƒ†ãƒ è¨­å®š
                  </Link>
                </Button>
              </div>
            </CardContent>
          </Card>
        </div>

        {/* è©³ç´°æƒ…å ±ã‚¿ãƒ– */}
        <Card>
          <CardHeader>
            <CardTitle>è©³ç´°æƒ…å ±</CardTitle>
          </CardHeader>
          <CardContent>
            <Tabs value={activeTab} onValueChange={setActiveTab}>
              <TabsList className="grid w-full grid-cols-3">
                <TabsTrigger value="overview">æ¦‚è¦</TabsTrigger>
                <TabsTrigger value="analytics">åˆ†æ</TabsTrigger>
                <TabsTrigger value="activities">æœ€è¿‘ã®æ´»å‹•</TabsTrigger>
              </TabsList>

              <TabsContent value="overview" className="space-y-4 mt-4">
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div className="space-y-3">
                    <h4 className="font-medium">å­¦å¹´åˆ¥å›³æ›¸å§”å“¡æ•°</h4>
                    <div className="space-y-2">
                      <div className="flex justify-between items-center">
                        <span className="text-sm">5å¹´ç”Ÿ</span>
                        <Badge variant="outline">
                          {stats?.students.grade5 || 0}å
                        </Badge>
                      </div>
                      <div className="flex justify-between items-center">
                        <span className="text-sm">6å¹´ç”Ÿ</span>
                        <Badge variant="outline">
                          {stats?.students.grade6 || 0}å
                        </Badge>
                      </div>
                    </div>
                  </div>

                  <div className="space-y-3">
                    <h4 className="font-medium">ã‚·ã‚¹ãƒ†ãƒ ä½¿ç”¨çŠ¶æ³</h4>
                    <div className="space-y-2">
                      <div className="flex justify-between items-center">
                        <span className="text-sm">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªå›³æ›¸å§”å“¡</span>
                        <Badge variant="outline">
                          {stats?.students.active || 0}å
                        </Badge>
                      </div>
                      <div className="flex justify-between items-center">
                        <span className="text-sm">å›³æ›¸å§”å“¡ãŒã„ã‚‹ã‚¯ãƒ©ã‚¹</span>
                        <Badge variant="outline">
                          {stats?.classes.withStudents || 0}ã‚¯ãƒ©ã‚¹
                        </Badge>
                      </div>
                    </div>
                  </div>
                </div>
              </TabsContent>

              <TabsContent value="analytics" className="space-y-4 mt-4">
                <div className="text-center py-8 text-muted-foreground">
                  <BarChart3 className="h-12 w-12 mx-auto mb-4" />
                  <p>è©³ç´°ãªåˆ†ææ©Ÿèƒ½ã¯ä»Šå¾Œå®Ÿè£…äºˆå®šã§ã™</p>
                </div>
              </TabsContent>

              <TabsContent value="activities" className="space-y-4 mt-4">
                {activitiesLoading ? (
                  <div className="flex items-center justify-center py-8">
                    <LoadingSpinner size="lg" text="æ´»å‹•å±¥æ­´ã‚’èª­ã¿è¾¼ã¿ä¸­..." />
                  </div>
                ) : activities.length === 0 ? (
                  <div className="text-center py-8 text-muted-foreground">
                    <Clock className="h-12 w-12 mx-auto mb-4" />
                    <p>æœ€è¿‘ã®æ´»å‹•ã¯ã‚ã‚Šã¾ã›ã‚“</p>
                  </div>
                ) : (
                  <div className="space-y-3">
                    {activities.slice(0, 10).map((activity) => (
                      <div key={activity.id} className="flex items-center gap-3 p-3 rounded-lg border">
                        <div className="w-2 h-2 bg-primary rounded-full" />
                        <div className="flex-1">
                          <p className="text-sm font-medium">{activity.description}</p>
                          <p className="text-xs text-muted-foreground">
                            {new Date(activity.timestamp).toLocaleString('ja-JP')}
                          </p>
                        </div>
                      </div>
                    ))}

                    {activities.length > 10 && (
                      <Button variant="outline" className="w-full">
                        <ArrowRight className="mr-2 h-4 w-4" />
                        ã™ã¹ã¦ã®æ´»å‹•ã‚’è¦‹ã‚‹
                      </Button>
                    )}
                  </div>
                )}
              </TabsContent>
            </Tabs>
          </CardContent>
        </Card>
      </div>
    </PageLayout>
  )
}
```

#### 2. Dashboard API Routes

##### src/app/api/dashboard/stats/route.ts

```typescript
import { NextRequest, NextResponse } from 'next/server'
import { prisma } from '@/lib/database'
import { authenticate } from '@/lib/auth/helpers'

export async function GET(request: NextRequest) {
  try {
    await authenticate(request)

    // ä¸¦åˆ—ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    const [studentsData, classesData, schedulesData, roomsData] =
      await Promise.all([
        // å›³æ›¸å§”å“¡çµ±è¨ˆ
        prisma.student
          .aggregate({
            _count: {
              id: true,
            },
            where: {},
          })
          .then(async (total) => {
            const [active, grade5, grade6] = await Promise.all([
              prisma.student.count({ where: { isActive: true } }),
              prisma.student.count({ where: { grade: 5 } }),
              prisma.student.count({ where: { grade: 6 } }),
            ])
            return {
              total: total._count.id,
              active,
              grade5,
              grade6,
            }
          }),

        // ã‚¯ãƒ©ã‚¹çµ±è¨ˆ
        prisma.class
          .aggregate({
            _count: {
              id: true,
            },
          })
          .then(async (total) => {
            const withStudents = await prisma.class.count({
              where: {
                students: {
                  some: {},
                },
              },
            })
            return {
              total: total._count.id,
              withStudents,
            }
          }),

        // ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«çµ±è¨ˆ
        Promise.all([
          prisma.assignment.aggregate({
            _count: { id: true },
            where: { term: 'FIRST_TERM' },
          }),
          prisma.assignment.aggregate({
            _count: { id: true },
            where: { term: 'SECOND_TERM' },
          }),
          prisma.assignment.findFirst({
            where: { term: 'FIRST_TERM' },
            orderBy: { createdAt: 'desc' },
            select: { createdAt: true },
          }),
          prisma.assignment.findFirst({
            where: { term: 'SECOND_TERM' },
            orderBy: { createdAt: 'desc' },
            select: { createdAt: true },
          }),
        ]).then(
          ([
            firstTermCount,
            secondTermCount,
            firstTermLatest,
            secondTermLatest,
          ]) => ({
            firstTerm: {
              exists: firstTermCount._count.id > 0,
              assignmentCount: firstTermCount._count.id,
              lastGenerated: firstTermLatest?.createdAt.toISOString() || null,
            },
            secondTerm: {
              exists: secondTermCount._count.id > 0,
              assignmentCount: secondTermCount._count.id,
              lastGenerated: secondTermLatest?.createdAt.toISOString() || null,
            },
          })
        ),

        // å›³æ›¸å®¤çµ±è¨ˆ
        prisma.room
          .aggregate({
            _count: {
              id: true,
            },
          })
          .then(async (total) => {
            const active = await prisma.room.count({
              where: { isActive: true },
            })
            return {
              total: total._count.id,
              active,
            }
          }),
      ])

    return NextResponse.json({
      success: true,
      data: {
        students: studentsData,
        classes: classesData,
        schedules: schedulesData,
        rooms: roomsData,
      },
    })
  } catch (error) {
    console.error('Dashboard stats error:', error)
    return NextResponse.json(
      {
        success: false,
        error: {
          code: 'INTERNAL_ERROR',
          message: 'ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çµ±è¨ˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ',
        },
      },
      { status: 500 }
    )
  }
}
```

##### src/app/api/dashboard/activities/route.ts

```typescript
import { NextRequest, NextResponse } from 'next/server'
import { prisma } from '@/lib/database'
import { authenticate } from '@/lib/auth/helpers'

export async function GET(request: NextRequest) {
  try {
    await authenticate(request)

    // æœ€è¿‘ã®æ´»å‹•ã‚’å–å¾—ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ activity ãƒ­ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆï¼‰
    // ã“ã“ã§ã¯ç°¡æ˜“çš„ã«æœ€è¿‘ä½œæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ´»å‹•ã‚’ç”Ÿæˆ
    const [recentStudents, recentClasses, recentAssignments] =
      await Promise.all([
        prisma.student.findMany({
          take: 5,
          orderBy: { createdAt: 'desc' },
          include: {
            class: {
              select: { name: true, year: true },
            },
          },
        }),
        prisma.class.findMany({
          take: 5,
          orderBy: { createdAt: 'desc' },
        }),
        prisma.assignment.findMany({
          take: 5,
          orderBy: { createdAt: 'desc' },
          include: {
            student: {
              select: { name: true },
            },
          },
        }),
      ])

    const activities = [
      ...recentStudents.map((student) => ({
        id: `student-${student.id}`,
        type: 'student_created' as const,
        description: `å›³æ›¸å§”å“¡ã€Œ${student.name}ã€ãŒ${student.class.year}å¹´${student.class.name}çµ„ã«ç™»éŒ²ã•ã‚Œã¾ã—ãŸ`,
        timestamp: student.createdAt.toISOString(),
      })),
      ...recentClasses.map((cls) => ({
        id: `class-${cls.id}`,
        type: 'class_created' as const,
        description: `ã‚¯ãƒ©ã‚¹ã€Œ${cls.year}å¹´${cls.name}çµ„ã€ãŒä½œæˆã•ã‚Œã¾ã—ãŸ`,
        timestamp: cls.createdAt.toISOString(),
      })),
      ...recentAssignments.map((assignment) => ({
        id: `assignment-${assignment.id}`,
        type: 'schedule_generated' as const,
        description: `ã€Œ${assignment.student.name}ã€ã®å½“ç•ªãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¾ã—ãŸ`,
        timestamp: assignment.createdAt.toISOString(),
      })),
    ].sort(
      (a, b) =>
        new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime()
    )

    return NextResponse.json({
      success: true,
      data: {
        activities: activities.slice(0, 20),
      },
    })
  } catch (error) {
    console.error('Dashboard activities error:', error)
    return NextResponse.json(
      {
        success: false,
        error: {
          code: 'INTERNAL_ERROR',
          message: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ',
        },
      },
      { status: 500 }
    )
  }
}
```

### Resources

- [Dashboard Design Patterns](https://ui-patterns.com/patterns/Dashboard)
- [Data Visualization Best Practices](https://www.tableau.com/learn/articles/data-visualization)
- [Analytics Dashboard Examples](https://dribbble.com/tags/dashboard)

## Implementation Results

### Work Completed

- [ ] ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸å®Ÿè£…
- [ ] çµ±è¨ˆæƒ…å ±è¡¨ç¤ºå®Ÿè£…
- [ ] **ä»Šæ—¥ã®å½“ç•ªè¡¨ç¤ºæ©Ÿèƒ½å®Ÿè£…** (æ–°è¦è¿½åŠ )
- [ ] **é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨ç¤ºæ©Ÿèƒ½å®Ÿè£…** (æ–°è¦è¿½åŠ )
- [ ] **ä»Šæ—¥ã®å½“ç•ªAPI (/api/dashboard/today-duties) å®Ÿè£…** (æ–°è¦è¿½åŠ )
- [ ] ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«çŠ¶æ³è¡¨ç¤ºå®Ÿè£…
- [ ] ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè£…
- [ ] æœ€è¿‘ã®æ´»å‹•è¡¨ç¤ºå®Ÿè£…
- [ ] ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰APIå®Ÿè£…
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œå®Ÿè£…

### Testing Results

- [ ] çµ±è¨ˆãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºç¢ºèª
- [ ] **ä»Šæ—¥ã®å½“ç•ªè¡¨ç¤ºæ©Ÿèƒ½ç¢ºèª** (æ–°è¦è¿½åŠ )
- [ ] **é€±é–“ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¡¨ç¤ºæ©Ÿèƒ½ç¢ºèª** (æ–°è¦è¿½åŠ )
- [ ] **ä»Šæ—¥ã®å½“ç•ªAPIå‹•ä½œç¢ºèª** (æ–°è¦è¿½åŠ )
- [ ] **åœŸæ—¥ãƒ»ç¥æ—¥ã®ã€Œå½“ç•ªãªã—ã€è¡¨ç¤ºç¢ºèª** (æ–°è¦è¿½åŠ )
- [ ] **ä»Šæ—¥ã®å½“ç•ªãƒã‚¤ãƒ©ã‚¤ãƒˆç¢ºèª** (æ–°è¦è¿½åŠ )
- [ ] ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¢ºèª
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–è¡¨ç¤ºç¢ºèª
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ç¢ºèª

### Code Review Feedback

<!-- ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ã®æŒ‡æ‘˜äº‹é …ã¨å¯¾å¿œã‚’è¨˜éŒ² -->

## Next Steps

ã“ã®Issueå®Œäº†å¾Œã®æ¬¡ã®ã‚¿ã‚¹ã‚¯ï¼š

1. Issue #024: å›³æ›¸å®¤ç®¡ç†ãƒšãƒ¼ã‚¸å®Ÿè£…
2. Issue #025: ã‚·ã‚¹ãƒ†ãƒ è¨­å®šãƒšãƒ¼ã‚¸å®Ÿè£…
3. Issue #026: ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸å®Ÿè£…
