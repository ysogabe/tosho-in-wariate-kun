# 図書委員当番割り当てシステム 画面設計書（第一フェーズ）

## 1. 画面構成概要

本システムの画面構成は以下の通りです：

```
トップページ
├── ログイン・認証 (未実装)
│   ├── ログイン画面
│   ├── ユーザー登録画面
│   └── パスワードリセット画面
├── 週間スケジュール表示画面 (メイン画面)
├── 管理画面
│   ├── 基本情報管理
│   │   ├── 学年管理画面
│   │   ├── クラス管理画面
│   │   ├── 図書委員管理画面
│   │   ├── 図書室管理画面
│   ├── スケジュール管理
│   │   ├── スケジュールルール設定画面
│   │   ├── スケジュール生成画面 (未実装)
│   │   ├── スケジュール編集画面 (未実装)
│   │   └── スケジュール検証画面 (未実装)
│   └── 出力・レポート (未実装)
│       └── 月間カレンダー表示画面
└── スケジュール編集画面 (未実装の別画面、週間スケジュール表示からリンク想定)
```

## 2. 共通UI要素

<!-- MODIFIED SECTION -->
### 2.1 ヘッダー

多くのページで共通のヘッダーが使用されます。例として週間スケジュール表示画面では以下の要素が配置されます：

- システムロゴ（左上）：「本のアイコン」と「図書当番割り当てくん」
- ユーザー関連（右上）
  - 「管理者さん」のようなユーザー名表示
  - 「ダッシュボードへ戻る」ボタン (他のページでは「管理画面トップへ」など状況に応じたナビゲーションボタン)

管理系のページでは、戻るボタンとページタイトルが左上に配置されます。

### 2.2 ナビゲーション

メインのナビゲーションは、各ページからのリンクやダッシュボード形式の管理画面トップページ (`/management`) によって提供されます。
管理画面トップページには以下のカテゴリへのリンクが想定されます：
- 基本情報管理
  - 学年管理
  - クラス管理
  - 図書委員管理
  - 図書室管理
- スケジュール管理
  - スケジュールルール設定
  - （その他未実装のスケジュール関連機能）

<!-- END MODIFIED SECTION -->

### 2.3 フッター

週間スケジュール表示画面など一部のページにはフッターが実装されています。
- コピーライト表示 (例: © 2025 図書当番割り当てくん)

## 3. 認証画面 (未実装)

### 3.1 ログイン画面

**画面要素：**
- システムロゴ
- ページタイトル「ログイン」
- メールアドレス入力フィールド
- パスワード入力フィールド
- ログインボタン
- パスワードを忘れた方リンク
- 新規登録リンク

**バリデーション：**
- メールアドレス：必須、メールアドレス形式
- パスワード：必須、8文字以上

### 3.2 ユーザー登録画面

**画面要素：**
- システムロゴ
- ページタイトル「新規ユーザー登録」
- 氏名入力フィールド
- メールアドレス入力フィールド
- パスワード入力フィールド
- パスワード確認入力フィールド
- 利用規約同意チェックボックス
- 登録ボタン
- ログインページへ戻るリンク

**バリデーション：**
- 氏名：必須
- メールアドレス：必須、メールアドレス形式、重複チェック
- パスワード：必須、8文字以上、英数字混在
- パスワード確認：必須、パスワードと一致
- 利用規約同意：必須

## 4. 基本情報管理画面

<!-- MODIFIED SECTION -->
### 4.1 学年管理画面 (`/management/grades`)

**画面要素：**
- ページタイトル「✨ 学年管理 ✨」
- 学年一覧テーブル
  - ID
  - 学年名
  - 説明
  - 操作（編集/削除ボタン）
- 「新規追加」ボタン

**学年登録/編集フォーム（モーダル風表示）：**
- フォームタイトル（「学年を編集」または「新しい学年を追加」）
- 学年名入力フィールド
- 説明入力フィールド
- 保存/キャンセルボタン

**バリデーション：**
- 学年名：必須

### 4.2 クラス管理画面 (`/management/classes`)

**画面要素：**
- ページタイトル「✨ クラス管理 ✨」
- クラス一覧テーブル
  - ID
  - クラス名
  - 学年 (例: `1年生`)
  - 操作（編集/削除ボタン）
- 「新規追加」ボタン

**クラス登録/編集フォーム（モーダル風表示）：**
- フォームタイトル（「クラスを編集」または「新しいクラスを追加」）
- クラス名入力フィールド (例: `1組`)
- 学年選択ドロップダウン (利用可能な学年から選択)
- 保存/キャンセルボタン

**バリデーション：**
- クラス名：必須
- 学年：必須

### 4.3 図書委員管理画面 (`/management/committee-members`)

**画面要素：**
- ページタイトル「✨ 図書委員管理 ✨」
- 図書委員一覧テーブル
  - ID
  - 名前
  - 学年 (例: `1年生`)
  - クラス (例: `1年1組`)
  - 役割
  - 操作（編集/削除ボタン）
- 「新規追加」ボタン

**図書委員登録/編集フォーム（モーダル風表示）：**
- フォームタイトル（「委員を編集」または「新しい委員を追加」）
- 名前入力フィールド
- クラス選択ドロップダウン (利用可能なクラスから選択、学年も表示)
- 役割選択ドロップダウン (例: 委員長, 副委員長, 書記, 会計, メンバー)
- 保存/キャンセルボタン

**バリデーション：**
- 名前：必須
- クラス：必須
- 役割：必須

### 4.4 図書室管理画面 (`/management/libraries`)

**画面要素：**
- ページタイトル「✨ 図書室管理 ✨」
- 学校設定セクション (学校名入力、保存ボタン)
- 図書室一覧表示 (カード形式)
  - 図書室名
  - 場所
  - 定員
  - 状態 (開館中/閉館中)
  - 利用可能時間 (曜日ごとの時間帯リスト)
  - 操作（編集/削除ボタン）
- 「新規追加」ボタン (図書室用)

**図書室登録/編集フォーム（モーダル風表示）：**
- フォームタイトル（「図書室を編集」または「新しい図書室を追加」）
- 図書室名入力フィールド
- 場所入力フィールド
- 定員入力フィールド
- 「開館中」チェックボックス (アクティブ状態)
- 利用可能時間セクション
  - 曜日選択ドロップダウン
  - 開始時間入力 (time input)
  - 終了時間入力 (time input)
  - 削除ボタン (各時間帯スロット用)
  - 「時間帯を追加」ボタン
- 保存/キャンセルボタン

**バリデーション：**
- 図書室名：必須
- 利用可能時間：開始時間と終了時間はペアで入力。終了時間は開始時間より後である必要あり（具体的なバリデーションはフロントエンドで強化が必要な場合あり）。

<!-- END MODIFIED SECTION -->

### 4.5 図書室利用時間設定画面
<!-- MODIFIED SECTION -->
この機能は図書室管理画面の編集フォームに統合されました。
<!-- END MODIFIED SECTION -->

## 5. スケジュール管理画面

<!-- MODIFIED SECTION -->
### 5.1 スケジュールルール設定画面 (`/management/schedule-rules`)

**画面要素：**
- ページタイトル「✨ スケジュールルール設定 ✨」
- ルール一覧テーブル
  - 優先度
  - ルール名
  - 説明
  - タイプ
  - 操作（編集/削除ボタン）
- 「新規ルール追加」ボタン

**ルール登録/編集フォーム（モーダル風表示）：**
- フォームタイトル（「ルールを編集」または「新しいルールを追加」）
- ルール名入力フィールド
- 説明テキストエリア
- タイプ選択ドロップダウン (例: `min_members_per_slot`, `custom` など)
- 優先度入力フィールド
- 保存/キャンセルボタン

**バリデーション：**
- ルール名：必須
- タイプ：必須
- 優先度：必須、数値
<!-- END MODIFIED SECTION -->

### 5.2 スケジュール生成画面 (未実装)

**画面要素：**
- ページタイトル「スケジュール生成」
- スケジュール名入力フィールド
- 説明テキストエリア
- 期間設定
  - 開始日選択
  - 終了日選択
- 対象図書委員選択（複数選択可能）
- 除外日設定ボタン（モーダル表示）
- スケジュール生成ボタン
- クリアボタン

**除外日設定モーダル：**
- 図書委員選択
- 除外日追加
  - 日付選択
  - 理由入力
  - 追加ボタン
- 除外日一覧
  - 日付
  - 理由
  - 削除ボタン
- 閉じるボタン

**バリデーション：**
- スケジュール名：必須
- 開始日：必須、現在日以降
- 終了日：必須、開始日より後
- 対象図書委員：1人以上選択

### 5.3 スケジュール確認・編集画面 (未実装)

**画面要素：**
- ページタイトル「スケジュール確認・編集」
- スケジュール選択ドロップダウン
- 期間選択（前期/後期）
- カレンダー表示切替（月/週）
- スケジュールカレンダー
  - 日付
  - 曜日
  - 図書室ごとの当番割り当て
- 検証ボタン
- 公開/非公開切替スイッチ
- 印刷ボタン

**当番割り当て編集モーダル：**
- 日付・図書室情報表示
- 現在の担当者表示
- 新担当者選択ドロップダウン
- 変更理由入力フィールド
- 保存/キャンセルボタン

**バリデーション：**
- 新担当者：必須
- 変更理由：変更時は必須

### 5.4 スケジュール検証結果画面 (未実装)

**画面要素：**
- ページタイトル「スケジュール検証結果」
- スケジュール情報表示
- 検証結果サマリー
  - 合格ルール数
  - 違反ルール数
- 違反ルール一覧
  - ルール名
  - 説明
  - 違反詳細
  - 重要度
- 詳細表示/非表示切替
- 印刷ボタン
- スケジュールに戻るボタン

## 6. 出力・レポート画面 (未実装)

### 6.1 月間カレンダー表示画面

**画面要素：**
- ページタイトル「月間カレンダー」
- スケジュール選択ドロップダウン
- 年月選択
- 前月/翌月移動ボタン
- 月間カレンダー表示
  - 日付ごとのセル
  - 図書室ごとの当番者表示
- 凡例表示
- 印刷ボタン

<!-- MODIFIED SECTION -->
### 6.2 週間スケジュール表示画面 (`/schedule/weekly`)

(メイン画面としても機能するため、詳細はセクション7を参照)
<!-- END MODIFIED SECTION -->

## 7. メイン画面（週間スケジュール表示画面 - `/schedule/weekly`）

<!-- MODIFIED SECTION -->
**画面要素：**
- ヘッダー（システムロゴ、ユーザー情報、ダッシュボード等へのナビゲーションボタン）
- ページタイトル「週間スケジュール」
- スケジュール選択ドロップダウン (利用可能なスケジュール一覧から選択)
- 週選択ナビゲーション
  - 「前週」ボタン
  - 「今週」ボタン
  - 「次週」ボタン
- 週間スケジュール表
  - ヘッダー行：曜日と日付 (例: 月 4/7)
  - 各日の列：
    - 当番割り当てカード (複数表示可能)
      - 時間帯 (例: 12:30-13:00)
      - 図書室名
      - 担当者名リスト (例: 山田太郎, 佐藤花子)
    - 当番なしの場合は「当番なし」と表示
- 「スケジュール編集」ボタン (別ページへのリンク)
- 凡例表示
- フッター (コピーライト)

**インタラクション:**
- スケジュールドロップダウンで選択したスケジュールの割り当てを表示。
- 週ナビゲーションボタンで表示週を切り替え。
- データロード中はローディング表示、エラー発生時はエラーメッセージ表示。
<!-- END MODIFIED SECTION -->

## 8. レスポンシブデザイン対応 (部分的、未検証)

本システムは以下の画面サイズに対応します：

- デスクトップ：1280px以上
- タブレット：768px～1279px
- モバイル：767px以下

各画面サイズごとの主な対応内容：

### 8.1 デスクトップ

- 全ての機能を横並びレイアウトで表示
- サイドナビゲーションを常時表示 (管理画面トップページなど)
- 複数カラムのテーブルレイアウト

### 8.2 タブレット

- 一部の機能を縦並びレイアウトに変更
- サイドナビゲーションは折りたたみ可能
- テーブルレイアウトの簡略化

### 8.3 モバイル

- 全ての機能を縦並びレイアウトに変更
- サイドナビゲーションはドロワーメニュー
- テーブルをカード型レイアウトに変更
- タッチ操作に最適化したUI

## 9. アクセシビリティ対応 (部分的、未検証)

本システムは以下のアクセシビリティ対応を目指します：

- WCAG 2.1 AAレベルへの準拠
- キーボード操作のサポート
- スクリーンリーダー対応
- 十分なコントラスト比の確保
- フォーカス可視化
- 代替テキストの提供

## 10. 色彩・デザイン仕様

<!-- MODIFIED SECTION -->
本システムは、Tailwind CSSフレームワークをベースとし、`globals.css` および `tailwind.config.ts` で定義されたテーマカラーを使用します。
可愛らしいパステルカラーのテイストを意識し、柔らかく親しみやすい印象を与えるデザインを目指します。

### 10.1 デザインコンセプト

- 丸みを持たせた要素と柔らかい印象 (例: `rounded-2xl`, `rounded-full`)
- `globals.css` で定義されたパステル調のカスタムカラー (`primary`, `secondary`, `accent`, `text`, `text-light`, `background`) を中心とした配色
- 可愛らしいアイコン (主に `react-icons/fa` を使用)
- 見出しに ✨（キラキラ）絵文字を使用

### 10.2 カラーパレット (Tailwind CSSによる定義)

- **背景色**: `bg-background` (CSS変数 `--background` で定義された薄い黄色系)
- **テキスト色**: `text-text` (CSS変数 `--text` で定義されたピンク系), `text-text-light`
- **プライマリカラー**: `bg-primary`, `text-primary` (CSS変数 `--primary` で定義されたミントグリーン系)
- **セカンダリカラー**: `border-secondary` (CSS変数 `--secondary` で定義された薄いピンク系)
- **アクセントカラー**: `accent-accent` (CSS変数 `--accent` で定義された薄いオレンジ系)
- **エラーカラー**: `text-red-500` (Tailwind標準色)
- **カード背景色**: `bg-white bg-opacity-80`

### 10.3 タイポグラフィ

- **フォントファミリー**:
  - 主に `Noto Sans JP` (`@fontsource/noto-sans-jp` により導入)
  - 代替フォントは一般的な sans-serif フォント (`Segoe UI`, `Hiragino Sans`, `Meiryo` など)
- **サイズ・太さ**: Tailwind CSS のユーティリティクラス (`text-xl`, `font-bold`, `text-sm` など) を使用して階層的に設定。

### 10.4 デザイン要素

- **ボタン**: `rounded-full` や `rounded-lg` を使用し丸みを持たせたデザイン。ホバーエフェクト (`hover:bg-primary-dark`)。
- **カード**: `rounded-2xl` または `rounded-xl`、`shadow-md`、一部で `border-2 border-dashed border-secondary` を使用。
- **アイコン**: `react-icons` を使用し、適度なサイズで表示。
- **テーブル**: `min-w-full bg-white`、ヘッダーは `bg-gray-100`。行は `border-b` で区切り、ホバー時に `hover:bg-gray-50`。
- **フォーム入力**: `rounded-lg border-2 border-gray-300` (または `border-secondary`)、フォーカス時に `focus:ring-2 focus:ring-primary`。
<!-- END MODIFIED SECTION -->

## 11. インタラクション仕様

### 11.1 フォームインタラクション

- 入力中のクライアントサイドバリデーション（例：必須項目）
- 送信時のローディングインジケーター（ボタンの無効化、テキスト変更）
- 成功/エラー通知（フォーム内またはページ上部にメッセージ表示）

### 11.2 テーブルインタラクション

- 行のホバーエフェクト (`hover:bg-gray-50`)
- （ソート、フィルター、ページネーションは未実装）

### 11.3 通知システム

- 成功通知（緑背景など）：ページ上部またはフォーム近辺に短時間表示後、自動で消えるか、手動で閉じることができる。
- エラー通知（赤文字など）：フォーム内またはページ上部に表示。
- 確認ダイアログ：ブラウザ標準の `confirm()` を使用。
